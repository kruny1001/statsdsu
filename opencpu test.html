<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="//cdn.opencpu.org/opencpu-0.4.js"></script>
</head>
<body>
<style>
    pre {
        position: relative;
        height: 50px;
    }
</style>
<h1>RStat </h1>
<button id="submitbutton">Smooth a Vector</button> <br>
<button id="crt">crt a Vector</button> <br>
<pre><code></code></pre>
<iframe id="output" width="833" height="350"></iframe>

<script>
    //set CORS to call "stocks" package on public server
    ocpu.seturl("//kruny1001.ocpu.io/rRemoteSDSU/R")


    var example2 = {
        src:'library(rCharts)\n'+
        'data(economics, package = "ggplot2")\n'+
        'econ <- transform(economics, date = as.character(date))\n' +
        'mPlot(x = "date", y = c("psavert", "uempmed"), type = "Line", data = econ, pointSize = 0, lineWidth = 1)',
        title:'Stock Info (Morris)',
        content:'The next library I will be exploring is MorrisJS'
    };


    var getSource = function(example){
        var req = ocpu.call("executeSrc", {
            text: example.src
        }, function(session){
            //element.find('iframe').attr('src', session.getLoc() + 'files/output.html');
            $("#output").attr('src', session.getLoc() + "files/output.html");

        }).fail(function(text){
            alert("Error: " + req.responseText);
        });
    }

    var makeChart = function(example){
        var mydata = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15];

        //call R function: stats::sd(x=data)
        var req = ocpu.rpc("stats/sd",{
            x : mydata
        }, function(output){
            alert("Standard Deviation equals: " + output);
        });

        //optional
        req.fail(function(){
            alert("R returned an error: " + req.responseText);
        });
    };

    $("#crt").click(function(){
        getSource(example2);
    });

    $("#submitbutton").click(function(){
        makeChart(example2);
    });

</script>
</body>
</html>